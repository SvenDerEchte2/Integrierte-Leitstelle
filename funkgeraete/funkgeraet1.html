<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Melder</title>
  <style>
    body {
      margin: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      background: #111;
    }

    .container {
      position: relative;
      display: inline-block;
    }

    #melder-image {
      display: block;
    }

    /* Buttons */
    .btn {
      position: absolute;
      background: #ff4c4c;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    /* Neuer Frame */
    #statusFrame {
      position: absolute;
      background-color: rgb(88, 88, 88); /* grünlich, halbtransparent */
      box-sizing: border-box;
    }
  </style>
</head>
<body>
  <div class="container">
    <img id="melder-image" src="funkhöhrer.png" alt="Funkhöhrer" />

    <!-- Buttons -->
    <button id="btn1" class="btn" style="top: 66.1%; left: 23.1%;">1</button>
    <button id="btn2" class="btn" style="top: 66.1%; left: 41.1%;">2</button>
    <button id="btn3" class="btn" style="top: 66.1%; left: 59.1%;">3</button>
    <button id="btn4" class="btn" style="top: 70.6%; left: 23.1%;">4</button>
    <button id="btn5" class="btn" style="top: 70.6%; left: 41.1%;">5</button>
    <button id="btn6" class="btn" style="top: 70.6%; left: 59.1%;">6</button>
    <button id="btn7" class="btn" style="top: 75.1%; left: 23.1%;">7</button>
    <button id="btn8" class="btn" style="top: 75.1%; left: 41.1%;">8</button>
    <button id="btn9" class="btn" style="top: 75.1%; left: 59.1%;">9</button>
    <button id="btn0" class="btn" style="top: 79.6%; left: 41.1%;">0</button>
    <button id="btnAbnehmen" class="btn" style="top: 59.3%; left: 23.1%;">0</button>
    <button id="btnAuflegen" class="btn" style="top: 59.3%; left: 64.1%;">0</button>

    <!-- Neuer Frame -->
    <div id="statusFrame"> 
      <p id="statusTime" style="display: none; color: rgb(0, 0, 0); margin: 0; font-size: 15px; text-align: right; margin-right: 3.5%;">
      12:59
      </p>
      <hr id="trennstrich" style="display: none; border: 1px solid rgb(0, 119, 255); margin-bottom: 3%; margin-top: 0%;" />
      <p id="statusDescription" style="display: none; color: rgb(0, 0, 0); margin-bottom: 10%; margin-top: 0%; font-size: 12px; text-align: center;">
      SB 1/HLF-20/1
      </p>
      <p id="statusDescription2" style="display: none; color: rgb(0, 0, 0); margin-bottom: 15%; margin-top: 0%; font-size: 17px; text-align: center; font-weight: bold;">
      FW_NETZ
      </p>
      <hr id="trennstrich2" style="display: none; border: 1px solid rgb(0, 119, 255); margin-bottom: 3%; margin-top: 0%;" />
      <p id="statusanzeige" style="display: none; color: rgb(0, 0, 0); margin-bottom: 0%; margin-top: 0%; font-size: 9.5px; text-align: center">
      E-Bereit Wache
      </p>
      <hr id="trennstrich3" style="display: none; border: 1px solid rgb(0, 119, 255); margin-bottom: 10%; margin-top: 0%;" />
      <p id="einsatzzahl" style="display: none; color: rgb(0, 0, 0); margin-bottom: 0%; margin-top: 0%; font-size: 9.5px; text-align: left; margin-left: 3.5%;">
      E: 0
      </p>
    </div>
  </div>

  <script>
    const scale = 0.8;

    const img = document.getElementById("melder-image");
    const btnAbnehmen = document.getElementById("btnAbnehmen");
    const btnAuflegen = document.getElementById("btnAuflegen");
    const statusFrame = document.getElementById("statusFrame");

    const buttons = [
      document.getElementById("btn0"),
      document.getElementById("btn1"),
      document.getElementById("btn2"),
      document.getElementById("btn3"),
      document.getElementById("btn4"),
      document.getElementById("btn5"),
      document.getElementById("btn6"),
      document.getElementById("btn7"),
      document.getElementById("btn8"),
      document.getElementById("btn9"),
    ];

    function setButtonSize(button, width, height, fontSize) {
      button.style.width = width + "px";
      button.style.height = height + "px";
      button.style.fontSize = fontSize + "px";
    }

    function setFrameProperties(frame, topPercent, leftPercent, widthPx, heightPx) {
      frame.style.top = topPercent + "%";
      frame.style.left = leftPercent + "%";
      frame.style.width = widthPx + "px";
      frame.style.height = heightPx + "px";
    }

    img.onload = () => {
      img.width = img.naturalWidth * scale;
      img.height = img.naturalHeight * scale;
      if (window.resizeTo) {
        window.resizeTo(img.width + 35, img.height + 70);
        window.moveTo(
          (screen.width - img.width) / 2,
          (screen.height - img.height) / 2
        );
      }

      buttons.forEach((btn) => setButtonSize(btn, 30, 23, 12));
      setButtonSize(btnAbnehmen, 21, 32, 14);
      setButtonSize(btnAuflegen, 21, 32, 14);

      // Frame initial positionieren
      setFrameProperties(statusFrame, 29.9, 24, 89.1, 118); // top: 50%, left: 30%, size: 60x30px
    };

    let globalCooldown = false;

    function playSoundWithCooldown() {
      if (globalCooldown) return;
      globalCooldown = true;

      buttons.forEach((btn) => (btn.disabled = true));

      const audio = new Audio("../Status.wav");
      audio.play();

      audio.onended = () => {
        globalCooldown = false;
        buttons.forEach((btn) => (btn.disabled = false));
      };
    }

    buttons.forEach((btn) => {
      btn.onclick = () => playSoundWithCooldown();
    });

    // Aktionen für Abnehmen & Auflegen
    btnAbnehmen.onclick = () => {
      console.log("Abgenommen");
    };

let auflegenTimer;

btnAuflegen.addEventListener('mousedown', () => {
  auflegenTimer = setTimeout(() => {
    // Hintergrundfarbe ändern & andere Inhalte anzeigen
    statusFrame.style.backgroundColor = "rgb(192, 199, 201)";
    console.log("Farbe geändert nach 2 Sekunden halten");

    statusTime.style.display = "block";
    statusDescription.style.display = "block";
    einsatzzahl.style.display = "block";
    statusanzeige.style.display = "block";
    trennstrich.style.display = "block";
    trennstrich2.style.display = "block";
    trennstrich3.style.display = "block";

    // statusDescription2 vorbereiten
    statusDescription2.style.display = "block";
    statusDescription2.style.opacity = "1";

    // Blinken (3x)
    let blinkCount = 0;
    const maxBlinks = 3;

    const blinkInterval = setInterval(() => {
      statusDescription2.style.opacity =
        statusDescription2.style.opacity === "1" ? "0" : "1";
      blinkCount++;

      if (blinkCount >= maxBlinks * 2) {
        clearInterval(blinkInterval);
        statusDescription2.style.opacity = "1"; // Sichtbar lassen
      }
    }, 800); // 400ms = ca. 2–3x Blinken in 2 Sekunden

  }, 2000); // Nach 2 Sekunden gedrückt halten
});

btnAuflegen.addEventListener('mouseup', () => {
  clearTimeout(auflegenTimer);
});

btnAuflegen.addEventListener('mouseleave', () => {
  clearTimeout(auflegenTimer);
});

  </script>

  <script type="module" src="funkgeraet1-logic.js"></script>
</body>
</html>